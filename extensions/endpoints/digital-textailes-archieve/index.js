"use strict";const t={".ico":"image/x-icon",".css":"text/css",".js":"application/javascript",".download":"application/javascript",".png":"image/png",".jpg":"image/jpeg",".jpeg":"image/jpeg",".svg":"image/svg+xml",".gif":"image/gif",".woff":"font/woff",".woff2":"font/woff2",".ttf":"font/ttf",".eot":"application/vnd.ms-fontobject"},e="/directus/extensions/endpoints/digital-textailes-archieve/static/Archieve_files",i="/directus/uploads",n="Icon-Textailes-Colour-RGB-Ver.png",s="default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https://ajax.googleapis.com; script-src-elem 'self' 'unsafe-inline' https://ajax.googleapis.com; connect-src 'self' https://ajax.googleapis.com https://www.gstatic.com blob:; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; font-src 'self' https://cdnjs.cloudflare.com; img-src 'self' data: blob:; worker-src 'self' blob:; child-src 'self' blob:;",a="http://localhost:8080",l="/api/v2",o="/a/thoth_v2/",c="textailes",r=[{key:"all",label:"All Use Cases",image:"Icon-Textailes-Colour-RGB-Ver.png"},{key:"1. greek ancient textiles",label:"1. Greek Ancient Textiles",image:"Use Case Preview/greek-ancient.jpg"},{key:"2. textile collection from pompeii",label:"2. Textile Collection from Pompeii",image:"Use Case Preview/pompeii.png"},{key:"3. greek bronz age clay sealings",label:"3. Greek Bronz Age clay sealings",image:"Use Case Preview/bronze-age.jpg"},{key:"4. imprints on human plaster casts from pompeii",label:"4. Imprints on human plaster casts from Pompeii",image:"Use Case Preview/plaster-casts.jpg"},{key:"5. benaki museum collection",label:"5. Benaki Museum collection",image:"Use Case Preview/benaki.jpg"},{key:"6. turku cathedral museum collection",label:"6. Turku Cathedral Museum collection",image:"Use Case Preview/turku-cathedral-museum-collection.png"},{key:"7. opera theatre archive in rome",label:"7. Opera Theatre Archive in Rome",image:"Use Case Preview/opera.png"},{key:"8. textile museum st. gallen collection",label:"8. Textile Museum St. Gallen Collection",image:"Use Case Preview/st. gallen.png"}],d={1:"1. greek ancient textiles",2:"2. textile collection from pompeii",3:"3. greek bronz age clay sealings",4:"4. imprints on human plaster casts from pompeii",5:"5. benaki museum collection",6:"6. turku cathedral museum collection",7:"7. opera theatre archive in rome",8:"8. textile museum st. gallen collection"},m=require("fs"),h=require("path"),p=(e,i,n=null)=>{if(!m.existsSync(e))return i.status(404).send("File not found");const s=h.extname(e).toLowerCase(),a=n||t[s];a&&i.set("Content-Type",a);const l=m.readFileSync(e);i.send(l)},v=(t,e,i)=>{const n=i&&t.use_case&&t.use_case.toString()===i.toString(),s=i&&t.title&&t.title.includes(i+".");return n||s},f=async(t,e,i)=>{const n=`artifact_${t}`,s={data:{title:e||`Artifact ${t}`,description:`3D model for artifact ${t}`},vis:1,fromItem:i};try{const t=`${a}${l}/scenes/`,e=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(`ATON API error: ${t.message||e.statusText}`)}const i=await e.json();return{success:!0,sceneId:n,sceneUrl:`${a}${o}?s=${n}`,sceneData:i}}catch(t){throw console.error("Error creating ATON scene:",t.message),new Error(`Failed to create ATON scene: ${t.message}`)}},g=async(t,e)=>{try{const i=`${a}${l}/scenes/${t}/${e}`,n=await fetch(i);if(!n.ok)return null;const s=await n.json();return{success:!0,sceneId:e,sceneUrl:`${a}${o}?s=${e}`,sceneJson:s}}catch(t){return console.error("Error fetching ATON scene:",t.message),null}},u=require("path"),b=require("fs"),x=require("obj2gltf"),y=require("crypto");var _=(t,{services:s})=>{const{ItemsService:a}=s,l=u.join(i,".glb_cache");b.existsSync(l)||b.mkdirSync(l,{recursive:!0}),t.get("/static/Archieve_files/*",(t,i)=>{const n=t.params[0],s=u.join(e,n);p(s,i)}),t.get("/favicon.ico",(t,i)=>{const s=u.join(e,n);p(s,i,"image/png")}),t.get("/assets/:fileId",async(t,e)=>{try{const n=new a("directus_files",{schema:t.schema,accountability:null}),s=await n.readOne(t.params.fileId);if(!s)return e.status(404).send("File not found");const o=u.join(i,s.filename_disk);if(!b.existsSync(o))return e.status(404).send("File not found on disk");e.set("Content-Type",s.type||"application/octet-stream"),e.set("Access-Control-Allow-Origin","*");let c=[];if(t.query.obj_files){const e=t.query.obj_files.split(",").filter(e=>e&&e!==t.params.fileId);e.length>0&&(c=await n.readByQuery({fields:["id","filename_disk","filename_download","type"],filter:{id:{_in:e}},limit:-1}))}if("model/obj"===s.type||s.filename_download.endsWith(".obj"))try{const a=c.map(t=>t.id).sort().join(","),r=y.createHash("md5").update(`${t.params.fileId}:${a}:${s.modified_on||s.uploaded_on}`).digest("hex"),d=u.join(l,`${r}.glb`);if(b.existsSync(d)){const t=b.readFileSync(d);return e.set("Content-Type","model/gltf-binary"),e.set("X-Cache","HIT"),e.send(t)}Date.now();let m=b.readFileSync(o,"utf8"),h=null,p=null,v=null,f=c.length>0?c:null;f||(f=await n.readByQuery({fields:["id","filename_disk","filename_download","type"],limit:-1}));const g=m.match(/^mtllib\s+(.+)$/m);if(g&&g[1]){const t=g[1].trim(),e=u.basename(t);let n=f.find(t=>("model/mtl"===t.type||t.filename_download.endsWith(".mtl"))&&t.filename_download.toLowerCase().includes(e.toLowerCase().replace(".mtl","")));if(n||(n=f.find(t=>"model/mtl"===t.type||t.filename_download.endsWith(".mtl"))),n){const t=u.join(i,n.filename_disk);h=b.readFileSync(t,"utf8");["map_Kd","map_Ka","map_Ks","map_Ns","map_d","map_bump","bump"].forEach(t=>{const e=new RegExp(`^${t}\\s+(.+)$`,"gm");h=h.replace(e,(e,i)=>{const n=u.basename(i.trim()),s=f.find(t=>t.type&&t.type.startsWith("image/")&&(t.filename_download.toLowerCase()===n.toLowerCase()||t.filename_download.toLowerCase().includes(n.toLowerCase().replace(/\.[^.]+$/,""))));return s?`${t} ${s.filename_disk}`:e})}),v=u.join(i,`temp_${Date.now()}_material.mtl`),b.writeFileSync(v,h),m=m.replace(/^mtllib\s+.+$/m,`mtllib ${u.basename(v)}`)}}p=u.join(i,`temp_${Date.now()}_model.obj`),b.writeFileSync(p,m);try{const t=await x(p,{binary:!0,packOcclusion:!0,metallicRoughness:!0,specularGlossiness:!1,unlit:!1});return b.writeFileSync(d,Buffer.from(t)),e.set("Content-Type","model/gltf-binary"),e.set("X-Cache","MISS"),e.send(Buffer.from(t))}finally{p&&b.existsSync(p)&&b.unlinkSync(p),v&&b.existsSync(v)&&b.unlinkSync(v)}}catch(t){return console.error("OBJ to GLB conversion error:",t),e.status(500).send("Error converting OBJ to GLB: "+t.message)}if("model/gltf+json"===s.type||s.filename_download.endsWith(".gltf")){const t=b.readFileSync(o,"utf8"),i=JSON.parse(t);return await(async(t,e)=>{const i=await e.readByQuery({fields:["id","filename_download"],limit:-1}),n=new Map(i.map(t=>[t.filename_download,t.id])),s=t=>{if(t.uri&&!t.uri.startsWith("data:")){const e=h.basename(t.uri),i=n.get(e);i&&(t.uri=i)}};return t.buffers?.forEach(s),t.images?.forEach(s),t})(i,n),e.set("Content-Type","model/gltf+json"),e.send(JSON.stringify(i))}("model/mtl"===s.type||s.filename_download.endsWith(".mtl"))&&e.set("Content-Type","model/mtl"),b.createReadStream(o).pipe(e)}catch(t){console.error("Asset error:",t),e.status(500).send("Error: "+t.message)}})};const w=(t="home")=>{const e=e=>t===e?"active":"";return`\n\x3c!-- Social Media Bar --\x3e\n<div class="social-media-bar" style="background-color: #265d72; padding: 8px 0;">\n    <div class="container">\n        <div class="row">\n            <div class="col-12 text-end">\n                <a href="https://github.com/TEXTaiLES" target="_blank" style="color: #ffffff; margin: 0 8px; text-decoration: none;">\n                    <i class="fab fa-github" style="font-size: 20px;"></i>\n                </a>\n                <a href="https://www.linkedin.com/company/textailes" target="_blank" style="color: #ffffff; margin: 0 8px; text-decoration: none;">\n                    <i class="fab fa-linkedin" style="font-size: 20px;"></i>\n                </a>\n                <a href="https://www.facebook.com/profile.php?id=61573869830011" target="_blank" style="color: #ffffff; margin: 0 8px; text-decoration: none;">\n                    <i class="fab fa-facebook" style="font-size: 20px;"></i>\n                </a>\n                <a href="https://www.instagram.com/textailes.eu/" target="_blank" style="color: #ffffff; margin: 0 8px; text-decoration: none;">\n                    <i class="fab fa-instagram" style="font-size: 20px;"></i>\n                </a>\n                <a href="https://x.com/textailes_eu" target="_blank" style="color: #ffffff; margin: 0 8px; text-decoration: none;">\n                    <i class="fab fa-x-twitter" style="font-size: 20px;"></i>\n                </a>\n                <a href="https://www.youtube.com/channel/UCcrHS8g095U2aCAo45d4eVg" target="_blank" style="color: #ffffff; margin: 0 8px; text-decoration: none;">\n                    <i class="fab fa-youtube" style="font-size: 20px;"></i>\n                </a>\n            </div>\n        </div>\n    </div>\n</div>\n\n<nav id="menu" class="ntnavbar navbar-expand-lg" aria-label="navbar">\n    <div class="container">\n        <div class="row mt-1">\n            <div class="col-md-2 col-sm-12">\n                <a class="navbar-brand" href="https://textailes-eccch.eu/">\n                    <img src="/digital-textailes-archieve/static/Archieve_files/Logo-Textailes_Logo-Textailes-Colour-RGB-Hor.svg" alt="Logo" style="margin-top: 10%;">Portal\n                </a>\n            </div>\n            <div class="col-md-10 col-sm-12 text-end">\n                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMenu">\n                    <span class="navbar-toggler-icon"><i class="fas fa-bars"></i></span>\n                </button>\n                <div class="collapse navbar-collapse horizontal_border" id="navbarMenu">\n                    <ul class="navbar-nav me-auto mb-2 mb-lg-0 nt_mtop text-uppercase">\n                        <li class="nav-item">\n                            <a class="nav-link py-1 ${e("home")}" href="/digital-textailes-archieve">Home</a>\n                        </li>\n                        <li class="nav-item">\n                            <a class="nav-link py-1 ${e("collections")}" href="/digital-textailes-archieve/collections">Collections</a>\n                        </li>\n                        <li class="nav-item">\n                            <a class="nav-link py-1 ${e("toolbox")}" href="/digital-textailes-archieve/toolbox">Toolbox</a>\n                        </li>\n                    </ul>\n                    <div class="d-flex align-items-center">\n                        <a href="/admin/login" class="text-decoration-none">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/Icons/header_login_icon.png" alt="Login" style="height: 30px;">\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</nav>`},A=({title:t,content:e,includeModelViewer:i=!1,bodyClass:n="",cspPolicy:s})=>`<!DOCTYPE html>\n<html lang="en" dir="ltr" data-bs-theme="light">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">\n    <title>${t}</title>\n    <link rel="icon" type="image/png" href="/digital-textailes-archieve/static/Archieve_files/Icon-Textailes-Colour-RGB-Ver.png">\n    <link type="text/css" href="/digital-textailes-archieve/static/Archieve_files/bootstrap.css" rel="stylesheet">\n    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw==" crossorigin="anonymous" referrerpolicy="no-referrer" />\n    <link type="text/css" href="/digital-textailes-archieve/static/Archieve_files/style.css" rel="stylesheet">\n    <link type="text/css" href="/digital-textailes-archieve/static/Archieve_files/css/home.css" rel="stylesheet">\n    ${i?'<script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"><\/script>':""}\n</head>\n<body${n?` ${n}`:""}>\n\n${e}\n\n<script src="/digital-textailes-archieve/static/Archieve_files/jquery-3.6.0.min.js.download"><\/script>\n<script src="/digital-textailes-archieve/static/Archieve_files/bootstrap.bundle.min.js.download"><\/script>\n</body>\n</html>`;var $=(t,{services:e})=>{const{ItemsService:i}=e;t.post("/aton/scene/:artifactId",async(t,e)=>{try{const n=new i("heritage_assets",{schema:t.schema,accountability:null}),s=await n.readByQuery({fields:["id","title","gltf_file","obj_file","obj_files.directus_files_id"],filter:{id:{_eq:t.params.artifactId}},limit:1});if(!s||0===s.length)return e.status(404).json({error:"Artifact not found"});const a=s[0],l=a.gltf_file||a.obj_file;if(!l)return e.status(400).json({error:"No 3D model available for this artifact"});const o=`${t.protocol}://${t.get("host")}`,c=a.obj_files?.map(t=>t.directus_files_id).filter(Boolean)||[];let r=`${o}/digital-textailes-archieve/assets/${l}`;a.obj_file&&c.length>0&&(r+=`?obj_files=${c.join(",")}`);const d=await f(a.id,a.title,r);e.json({...d,artifactId:a.id,artifactTitle:a.title,modelUrl:r})}catch(t){console.error("Create ATON scene error:",t),e.status(500).json({error:"Failed to create ATON scene",message:t.message})}}),t.get("/aton/scene/:artifactId",async(t,e)=>{try{const i=`artifact_${t.params.artifactId}`,n=t.query.user||c,s=await g(n,i);if(!s)return e.status(404).json({error:"Scene not found",message:`Scene ${i} not found for user ${n}. You may need to create it first.`,createEndpoint:`/digital-textailes-archieve/aton/scene/${t.params.artifactId}`});e.json(s)}catch(t){console.error("Get ATON scene error:",t),e.status(500).json({error:"Failed to get ATON scene",message:t.message})}}),t.get("/aton/scenes",async(t,e)=>{try{const t=await(async()=>{try{const t=`${a}${l}/scenes/`,e=await fetch(t);if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(`ATON API error: ${t.message||e.statusText}`)}return{success:!0,scenes:await e.json()}}catch(t){throw console.error("Error listing ATON scenes:",t.message),new Error(`Failed to list ATON scenes: ${t.message}`)}})();e.json({...t,baseUrl:a,thothPath:o})}catch(t){console.error("List ATON scenes error:",t),e.status(500).json({error:"Failed to list ATON scenes",message:t.message})}}),t.get("/aton/scene/:artifactId/url",async(t,e)=>{try{const n=new i("heritage_assets",{schema:t.schema,accountability:null}),s=await n.readByQuery({fields:["id","title","gltf_file","obj_file","obj_files.directus_files_id"],filter:{id:{_eq:t.params.artifactId}},limit:1});if(!s||0===s.length)return e.status(404).json({error:"Artifact not found"});const a=s[0],l=`artifact_${a.id}`,o=t.query.user||c;let r=await g(o,l);if(!r){const i=a.gltf_file||a.obj_file;if(!i)return e.status(400).json({error:"No 3D model available"});const n=`${t.protocol}://${t.get("host")}`,s=a.obj_files?.map(t=>t.directus_files_id).filter(Boolean)||[];let l=`${n}/digital-textailes-archieve/assets/${i}`;a.obj_file&&s.length>0&&(l+=`?obj_files=${s.join(",")}`),r=await f(a.id,a.title,l)}e.json({...r,artifactId:a.id,artifactTitle:a.title})}catch(t){console.error("Get/create scene URL error:",t),e.status(500).json({error:"Failed to get scene URL",message:t.message})}})};module.exports=(t,e)=>{_(t,e),((t,{services:e})=>{const{ItemsService:i}=e;t.get("/collections/:usecase?",async(t,e)=>{try{const n=t.params.usecase,a=!n;let l=n||"all";if("all-use-cases"===l)l="all";else if(l.startsWith("use-case-")){const t=l.replace("use-case-","");l=d[t]||l}const o=new i("heritage_assets",{schema:t.schema,accountability:null}),c=await o.readByQuery({fields:["id","title","gltf_file","obj_file","obj_files","use_case","collection","source","time_period"],limit:-1}),m="all"!==l?l.match(/\d+/)?.[0]:null,h="all"===l?c:c.filter(t=>v(t,0,m)),p=(h.length?h.map(t=>`\n\t\t\t\t\t<div class="col-md-4 col-sm-6 mb-4">\n\t\t\t\t\t\t<a href="/digital-textailes-archieve/artifact/${t.id}" class="text-decoration-none">\n\t\t\t\t\t\t\t<div class="card h-100">\n\t\t\t\t\t\t\t\t<div style="height: 200px; background: #f8f9fa; display: flex; align-items: center; justify-content: center;">\n\t\t\t\t\t\t\t\t\t${t.gltf_file||t.obj_file?`<model-viewer \n\t\t\t\t\t\t\t\t\t\tsrc="/digital-textailes-archieve/assets/${t.gltf_file||t.obj_file}${t.obj_file&&t.obj_files?"?obj_files="+t.obj_files:""}"\n\t\t\t\t\t\t\t\t\t\talt="${t.title||"3D Model"}"\n\t\t\t\t\t\t\t\t\t\tauto-rotate\n\t\t\t\t\t\t\t\t\t\tcamera-controls\n\t\t\t\t\t\t\t\t\t\tstyle="width: 100%; height: 100%;">\n\t\t\t\t\t\t\t\t\t</model-viewer>`:'<div class="text-muted">No 3D model</div>'}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="card-body">\n\t\t\t\t\t<h6 class="card-title">${t.title||"Untitled"}</h6>\n\t\t\t\t\t<span class="badge mb-2" style="color: #265d72;">Heritage Asset</span>\n\t\t\t\t\t${t.use_case?`<p class="text-muted small mb-1">Use Case ${t.use_case}</p>`:""}\n\t\t\t\t\t<small class="text-muted">${t.collection||""} ${t.time_period?"• "+t.time_period:""}</small>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</a>\n\t</div>\n`).join("\n"):"")||'<div class="col-12"><p class="text-muted">No artifacts found for this use case</p></div>',f=r.map(t=>{const e=t.key===l.toLowerCase(),i=t.key.match(/^(\d+)\./)?.[1],n="all"===t.key?"/digital-textailes-archieve/collections/all-use-cases":`/digital-textailes-archieve/collections/use-case-${i}`,s="all"===t.key?c.length:c.filter(e=>v(e,t.key,i)).length;return`\n\t\t\t\t\t<div class="col-md-4 col-sm-6 mb-3">\n\t\t\t\t\t\t<a href="${n}" class="text-decoration-none">\n\t\t\t\t\t\t\t<div class="card ${e?"border-primary":""}">\n\t\t\t\t\t\t\t\t<img src="/digital-textailes-archieve/static/Archieve_files/${t.image}" class="card-img-top" alt="${t.label}" style="height: 150px; object-fit: contain; padding: 10px;">\n\t\t\t\t\t\t\t\t<div class="card-body">\n\t\t\t\t\t\t\t\t\t<h6 class="card-title ${e?"text-primary":""}">${t.label}</h6>\n\t\t\t\t\t\t\t\t\t<p class="card-text text-muted">${s} artifact(s)</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>`}).join("\n"),g=`\n${w("collections")}\n\n\x3c!-- Hero Section --\x3e\n<div class="hero-section">\n    <div class="container">\n        <h1>Collections</h1>\n        <p>Explore Our Cultural Heritage Archives</p>\n    </div>\n</div>\n\n<div class="container mb-5">\n    <div class="row mt-3">\n        <div class="col-0 col-lg-2"></div>\n        <div class="col-12 col-lg-10">\n\t\t\t${a?`\n\t\t\t\t<div class="row mt-4">\n\t\t\t\t\t${f}\n\t\t\t\t</div>\n\t\t\t`:`\n\t\t\t\t<h2>${"all"===l?"All Use Cases":r.find(t=>t.key===l.toLowerCase())?.label||l.toUpperCase()}</h2>\n\t\t\t\t<p class="text-muted">${h.length} artifact(s) found</p>\n\t\t\t\t<div class="row mt-4">\n\t\t\t\t\t${p}\n\t\t\t\t</div>\n\t\t\t\t<p class="mt-3"><a href="/digital-textailes-archieve/collections">← Back to Collections</a></p>\n\t\t\t`}\n\t\t</div>\n    </div>\n</div>\n\n\n<footer class="footer mt-auto">\n    <div class="dark-footer h-75">\n        <div class="container py-4">\n            <div class="row dark-footer">\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center py-2">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/EN_FundedbytheEU_RGB_NEG-1024x228.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<div class="footerLink pt-1">\n                        <p>TEXTaiLES is a project funded by the European Commission under Grant Agreement n.101158328. The views and opinions expressed in this website are the sole responsibility of the author and do not necessarily reflect the views of the European Commission.</p>\n                        <p><small><br>\n                        <br>\n                        <br>\n                        <a class="plainlink" href="mailto:archive@n-t.gr" title="contact us" alt="contact mail"></a></small></p>\n                    </div>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/ECHOES_Logo_White_Horizontal_300x300-1024x221.png" style="max-width: 300px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<p>TEXTaiLES is part of the ECCCH initiative.</p>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/WBF_SBFI_EU_Frameworkprogramme_E_RGB_neg_hoch.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n                </div>\n            </div>\n        </div>\n    </div>\n</footer>`,u=A({title:"Collections - Digital Textailes Archive",content:g,includeModelViewer:!a,cspPolicy:s});e.set("Content-Type","text/html"),e.set("Content-Security-Policy",s),e.send(u)}catch(t){console.error("Collections error:",t),e.status(500).send("Error: "+t.message)}})})(t,e),((t,{services:e})=>{const{ItemsService:i}=e;t.get("/artifact/:id",async(t,e)=>{try{const n=new i("heritage_assets",{schema:t.schema,accountability:null}),l=await n.readByQuery({fields:["id","title","gltf_file","obj_file","obj_files.directus_files_id","description","date_timespan","dimensions","heritage_asset_owner","category_of_textile","keywords","inventory_number","origin","digitization_methods","digitization_actor","resolution","accession_number","reference_name_number","material_analyzed","object_status","condition_assessment","state_of_preservation","type_of_preservation","temperature","humidity","type_of_container","mount","result","conservation_date","cleaning","introduction_of_foreign_material","specific_foreign_material_introduce","creator","sensor","location","source","time_period","collection","use_case"],filter:{id:{_eq:t.params.id}},limit:1});if(!l||0===l.length)return e.status(404).send("Artifact not found");const r=l[0];let d="";if(r.gltf_file)d=`/digital-textailes-archieve/assets/${r.gltf_file}`;else if(r.obj_file){const t=r.obj_files?.map(t=>t.directus_files_id).filter(Boolean)||[];d=t.length>0?`/digital-textailes-archieve/assets/${r.obj_file}?obj_files=${t.join(",")}`:`/digital-textailes-archieve/assets/${r.obj_file}`}const m=`artifact_${r.id}`;let h=`${a}${o}?s=${m}`;try{const t=await g(c,m);t&&(h=t.sceneUrl)}catch(t){console.log(`Scene ${m} not found in ATON, but URL will still be provided`)}const p=`\n${w("collections")}\n\n<div class="container mb-5">\n    <div class="row mt-3">\n        <div class="col-0 col-lg-2"></div>\n        <div class="col-12 col-lg-10">\n            <nav aria-label="breadcrumb">\n                <ol class="breadcrumb">\n                    <li class="breadcrumb-item"><a href="https://textailes-eccch.eu/">Home</a></li>\n                    <li class="breadcrumb-item"><a href="/digital-textailes-archieve/collections">Collections</a></li>\n                    <li class="breadcrumb-item active" aria-current="page">${r.title||"Artifact"}</li>\n                </ol>\n            </nav>\n        </div>\n    </div>\n\n    <div class="row mt-3">\n        <div class="col-0 col-lg-2"></div>\n        <div class="col-12 col-lg-8">\n            <div class="mt-3 mb-4">\n                <div id="heritageAsset-model" style="height: 555px;">\n                   <model-viewer\n                     src="${d}"\n                     camera-controls\n                     auto-rotate\n                     environment-image="neutral"\n                     exposure="0.7"\n                     shadow-intensity="3"\n                     tone-mapping="neutral"\n                     style="width:100%; height:100%;">\n                   </model-viewer>\n                </div>\n            </div>\n\n            <div class="row mt-4">\n                <div class="col-12 text-end mb-3">\n                    <div class="feature-card" style="display: inline-block;">\n                        <button onclick="annotateWithThoth(${r.id})" class="btn btn-primary">\n                            <i class="fas fa-edit"></i> Annotate with THOTH\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            <script>\n                /**\n                 * Annotate with THOTH - Main function\n                 * \n                 * This function:\n                 * 1. Shows loading spinner on button\n                 * 2. Calls API endpoint to get or create ATON scene\n                 * 3. Opens THOTH annotator in new tab with the scene\n                 */\n                async function annotateWithThoth(artifactId) {\n                    const btn = event.target.closest('button');\n                    const originalText = btn.innerHTML;\n                    btn.disabled = true;\n                    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Preparing scene...';\n                    \n                    try {\n                        // Call endpoint that gets existing scene or creates new one\n                        const response = await fetch('/digital-textailes-archieve/aton/scene/' + artifactId + '/url');\n                        const data = await response.json();\n                        \n                        if (data.success) {\n                            console.log('Scene data:', data);\n                            // Open THOTH with the scene\n                            window.open(data.sceneUrl, '_blank');\n                        } else {\n                            alert('Error: ' + (data.message || 'Failed to prepare scene'));\n                        }\n                    } catch (error) {\n                        alert('Error: ' + error.message);\n                    } finally {\n                        btn.disabled = false;\n                        btn.innerHTML = originalText;\n                    }\n                }\n            <\/script>\n\n            <div class="row mt-4">\n\n                \x3c!-- Heritage Asset Section --\x3e\n                <div class="col-12 mb-4">\n                    <h4 class="border-bottom pb-2">Heritage Asset</h4>\n                    <div class="row">\n                        <div class="col-12">\n                            <dl>\n                                <dt class="samewidth">Title:</dt>\n                                <dd>${r.title||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Description:</dt>\n                                <dd>${r.description||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Date - Timespan:</dt>\n                                <dd>${r.date_timespan||"N/A"}</dd>\n\n                                <dt class="samewidth">Dimensions:</dt>\n                                <dd>${r.dimensions||"N/A"}</dd>\n\n                                <dt class="samewidth">Heritage Asset Owner:</dt>\n                                <dd>${r.heritage_asset_owner||"N/A"}</dd>\n\n                                <dt class="samewidth">Category of Textile:</dt>\n                                <dd>${r.category_of_textile||"N/A"}</dd>\n\n                                <dt class="samewidth">Keywords:</dt>\n                                <dd>${r.keywords||"N/A"}</dd>\n\n                                <dt class="samewidth">Inventory Number:</dt>\n                                <dd>${r.inventory_number||"N/A"}</dd>\n\n                                <dt class="samewidth">Origin:</dt>\n                                <dd>${r.origin||"N/A"}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Digital Asset Section --\x3e\n                <div class="col-12 mb-4">\n                    <h4 class="border-bottom pb-2">Digital Asset</h4>\n                    <div class="row">\n                        <div class="col-12">\n                            <dl>\n                                <dt class="samewidth">Digitization methods:</dt>\n                                <dd>${r.digitization_methods||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Digitization Actor:</dt>\n                                <dd>${r.digitization_actor||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Resolution:</dt>\n                                <dd>${r.resolution||"N/A"}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Additional Information (toggle only) --\x3e\n                <div class="col-12 mb-4">\n                    <div class="d-flex align-items-center justify-content-end border-bottom pb-2"\n                    role="button"\n                    data-bs-toggle="collapse"\n                    data-bs-target="#additionalInfoCollapse"\n                    aria-expanded="false"\n                    aria-controls="additionalInfoCollapse">\n                    <div class="d-flex align-items-center">\n                        <h4 class="mb-0 fs-6"><em>Additional Information</em></h4>\n                        <i class="fas fa-chevron-down ms-1 rotate-on-open"></i>\n                    </div>\n                </div>\n\n                \x3c!-- Collapsible content (everything hidden until click) --\x3e\n                <div class="collapse mt-3" id="additionalInfoCollapse">\n\n                \x3c!-- Identification Section --\x3e\n                <div class="col-12 mb-4">\n                        <h4 class="border-bottom pb-2">Identification</h4>\n                        <div class="row">\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Title:</dt>\n                                <dd>${r.title||"N/A"}</dd>\n                                \n                                <dt class="samewidth">ID:</dt>\n                                <dd>${r.id||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Accession Number:</dt>\n                                <dd>${r.accession_number||"N/A"}</dd>\n                            </dl>\n                        </div>\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Reference Name/Number:</dt>\n                                <dd>${r.reference_namenumber||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Material Analyzed:</dt>\n                                <dd>${r.material_analyzed||"N/A"}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                \n\n                \x3c!-- Condition Section --\x3e\n                <div class="col-12 mb-4">\n                    <h4 class="border-bottom pb-2">Condition</h4>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Object Status:</dt>\n                                <dd>${r.object_status||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Condition Assessment:</dt>\n                                <dd>${r.condition_assessment||"N/A"}</dd>\n                            </dl>\n                        </div>\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">State of Preservation:</dt>\n                                <dd>${r.state_of_preservation||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Type of Preservation:</dt>\n                                <dd>${r.type_of_preservation||"N/A"}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Preventive Conservation Section --\x3e\n                <div class="col-12 mb-4">\n                    <h4 class="border-bottom pb-2">Preventive Conservation</h4>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Temperature:</dt>\n                                <dd>${r.temperature?r.temperature+"°C":"N/A"}</dd>\n                                \n                                <dt class="samewidth">Humidity:</dt>\n                                <dd>${r.humidity?r.humidity+"% RH":"N/A"}</dd>\n                                \n                                <dt class="samewidth">Type of Container:</dt>\n                                <dd>${r.type_of_container||"N/A"}</dd>\n                            </dl>\n                        </div>\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Mount:</dt>\n                                <dd>${r.mount||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Result:</dt>\n                                <dd>${r.result?`<a href="${r.result}" target="_blank">View</a>`:"N/A"}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Interventive Conservation Section --\x3e\n                <div class="col-12 mb-4">\n                    <h4 class="border-bottom pb-2">Interventive Conservation</h4>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Conservation Date:</dt>\n                                <dd>${r.conservation_date||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Cleaning:</dt>\n                                <dd>${!0===r.cleaning?"Yes":!1===r.cleaning?"No":"N/A"}</dd>\n                            </dl>\n                        </div>\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Foreign Material Introduced:</dt>\n                                <dd>${r.introduction_of_foreign_material||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Specific Foreign Material:</dt>\n                                <dd>${r.specific_foreign_material_introduce||"N/A"}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Additional Information Section --\x3e\n                <div class="col-12 mb-4">\n                    <h4 class="border-bottom pb-2">Additional Information</h4>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Use Case:</dt>\n                                <dd>${r.use_case||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Collection:</dt>\n                                <dd>${r.collection||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Time Period:</dt>\n                                <dd>${r.time_period||"N/A"}</dd>\n                            </dl>\n                        </div>\n                        <div class="col-md-6">\n                            <dl>\n                                <dt class="samewidth">Creator:</dt>\n                                <dd>${r.creator||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Sensor:</dt>\n                                <dd>${r.sensor||"N/A"}</dd>\n                                \n                                <dt class="samewidth">Location:</dt>\n                                <dd>${r.location||"N/A"}</dd>\n                            </dl>\n                        </div>\n                    </div>\n                </div>\n            </div>\n                </div>\n                </div>\n            \n            <p class="mt-3"><a href="/digital-textailes-archieve/collections">← Back to Collections</a></p>\n        </div>\n        <div class="col-0 col-lg-2"></div>\n    </div>\n</div>\n\n\n<footer class="footer mt-auto">\n    <div class="dark-footer h-75">\n        <div class="container py-4">\n            <div class="row dark-footer">\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center py-2">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/EN_FundedbytheEU_RGB_NEG-1024x228.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<div class="footerLink pt-1">\n                        <p>TEXTaiLES is a project funded by the European Commission under Grant Agreement n.101158328. The views and opinions expressed in this website are the sole responsibility of the author and do not necessarily reflect the views of the European Commission.</p>\n                        <p><small><br>\n                        <br>\n                        <br>\n                        <a class="plainlink" href="mailto:archive@n-t.gr" title="contact us" alt="contact mail"></a></small></p>\n                    </div>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/ECHOES_Logo_White_Horizontal_300x300-1024x221.png" style="max-width: 300px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<p>TEXTaiLES is part of the ECCCH initiative.</p>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/WBF_SBFI_EU_Frameworkprogramme_E_RGB_neg_hoch.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n                </div>\n            </div>\n        </div>\n    </div>\n</footer>`,v=A({title:`${r.title||"Artifact"} - Digital Textailes Archive`,content:p,includeModelViewer:!0,bodyClass:'id="heritageAsset" tabindex="0"',cspPolicy:s});e.set("Content-Type","text/html"),e.set("Content-Security-Policy",s),e.send(v)}catch(t){console.error("Artifact view error:",t),e.status(500).send("Error: "+t.message)}})})(t,e),(t=>{t.get("/toolbox",async(t,e)=>{try{const t=[{name:"AmalthAI",image:"Logos/AmalthAI_Logo.png",links:[{label:"Documentation",url:"https://textailes.github.io/AmalthAI-documentation/"},{label:"GitHub",url:"https://github.com/TEXTaiLES/AmalthAI"},{label:"Server",url:"#"}]},{name:"THOTH",image:"Logos/thoth-logo.png",links:[{label:"Documentation",url:"https://textailes.github.io/thoth-documentation/"},{label:"GitHub",url:"https://github.com/TEXTaiLES/THOTH"},{label:"Server",url:"#"}]},{name:"ZEUSbot",image:"Icon-Textailes-Colour-RGB-Ver.png",links:[{label:"Documentation",url:"https://textailes.github.io/UGV-documentation/"},{label:"GitHub",url:"https://github.com/TEXTaiLES/ZEUSbot"}]},{name:"NEFELE",image:"Logos/nephele_logo_2.png",links:[{label:"Documentation",url:"https://textailes.github.io/SAMplify_SuGaR-documentation/"},{label:"GitHub",url:"https://github.com/TEXTaiLES/SAMplify_SuGaR"},{label:"Server",url:"#"}]},{name:"HESTIA",image:"Icon-Textailes-Colour-RGB-Ver.png",links:[{label:"Documentation",url:"http://textailes.athenarc.gr:5000/docs"},{label:"GitHub",url:"https://github.com/TEXTaiLES/HESTIA"},{label:"Server",url:"#"}]},{name:"INDRA",image:"Logos/env_cond_mon_logo.png",links:[{label:"Documentation",url:"https://textailes.github.io/Environmental-Condition-Monitoring-documentation/"},{label:"GitHub",url:"https://github.com/TEXTaiLES/Environmental-Condition-Monitoring"},{label:"Server",url:"#"}]}].map(t=>{const e=`/digital-textailes-archieve/static/Archieve_files/${t.image}`,i=t.links.map(t=>`<div><a href="${t.url}" class="text-decoration-none text-primary small">${t.label}</a></div>`).join("");return`\n\t\t\t\t\t<div class="col-md-6 mb-3">\n\t\t\t\t\t\t<div class="card">\n\t\t\t\t\t\t\t<div class="card-body">\n\t\t\t\t\t\t\t\t<div class="row align-items-center">\n\t\t\t\t\t\t\t\t\t<div class="col-3">\n\t\t\t\t\t\t\t\t\t\t<img src="${e}" alt="${t.name}" class="img-fluid" style="max-height: 80px; object-fit: contain;">\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="col-5">\n\t\t\t\t\t\t\t\t\t\t<h5 class="card-title mb-0">${t.name}</h5>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="col-4 text-end">\n\t\t\t\t\t\t\t\t\t\t${i}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`}).join("\n"),i=`\n${w("toolbox")}\n\n\x3c!-- Hero Section --\x3e\n<div class="hero-section">\n    <div class="container">\n        <h1>Digital Toolbox</h1>\n        <p>Our Tools for Cultural Heritage</p>\n    </div>\n</div>\n\n<div class="container mb-5">\n    <div class="row mt-3">\n        <div class="col-0 col-lg-2"></div>\n        <div class="col-12 col-lg-10">\n\t\t\t<div class="row mt-4">\n\t\t\t\t${t}\n\t\t\t</div>\n\t\t\t<p class="mt-3"><a href="/digital-textailes-archieve">Back to Home</a></p>\n        </div>\n    </div>\n</div>\n\n\n<footer class="footer mt-auto">\n    <div class="dark-footer h-75">\n        <div class="container py-4">\n            <div class="row dark-footer">\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center py-2">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/EN_FundedbytheEU_RGB_NEG-1024x228.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<div class="footerLink pt-1">\n                        <p>TEXTaiLES is a project funded by the European Commission under Grant Agreement n.101158328. The views and opinions expressed in this website are the sole responsibility of the author and do not necessarily reflect the views of the European Commission.</p>\n                        <p><small><br>\n                        <br>\n                        <br>\n                        <a class="plainlink" href="mailto:archive@n-t.gr" title="contact us" alt="contact mail"></a></small></p>\n                    </div>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/ECHOES_Logo_White_Horizontal_300x300-1024x221.png" style="max-width: 300px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<p>TEXTaiLES is part of the ECCCH initiative.</p>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/WBF_SBFI_EU_Frameworkprogramme_E_RGB_neg_hoch.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n                </div>\n            </div>\n        </div>\n    </div>\n</footer>`,n=A({title:"Toolbox - Digital Textailes Archive",content:i,cspPolicy:s});e.set("Content-Type","text/html"),e.set("Content-Security-Policy",s),e.send(n)}catch(t){console.error("Toolbox error:",t),e.status(500).send("Error: "+t.message)}})})(t),((t,{services:e})=>{const{ItemsService:i}=e;t.get("/",async(t,e)=>{const n=new i("heritage_assets",{schema:t.schema,accountability:null});try{const t=await n.readByQuery({fields:["id","title","gltf_file","obj_file"],limit:-1}),i=t.length,a=t[0]||{},l=`<!DOCTYPE html>\n<html lang="en" dir="ltr" data-bs-theme="light">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">\n    <title>Digital TEXTaiLES Archive</title>\n    <link rel="icon" type="image/png" href="/digital-textailes-archieve/static/Archieve_files/Icon-Textailes-Colour-RGB-Ver.png">\n    <link type="text/css" href="/digital-textailes-archieve/static/Archieve_files/bootstrap.css" rel="stylesheet">\n    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw==" crossorigin="anonymous" referrerpolicy="no-referrer" />\n    <link type="text/css" href="/digital-textailes-archieve/static/Archieve_files/style.css" rel="stylesheet">\n    <link type="text/css" href="/digital-textailes-archieve/static/Archieve_files/css/home.css" rel="stylesheet">\n    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"><\/script>\n</head>\n<body>\n\n${w("home")}\n\n\x3c!-- Hero Section --\x3e\n<div class="hero-section">\n    <div class="container">\n        <h1>Digital TEXTaiLES Archive</h1>\n        <p>Preserving Cultural Heritage Through 3D Digitization</p>\n    </div>\n</div>\n\n\x3c!-- About Section --\x3e\n<div class="container">\n    <div class="about-section">\n        <h2>About TEXTaiLES</h2>\n        <p>The TEXTaiLES project aims to preserve and digitize cultural heritage artifacts through advanced 3D scanning and AI-powered reconstruction techniques. Our archive brings together ancient textiles, archaeological finds, and museum collections, making them accessible to researchers and the public worldwide.</p>\n    </div>\n\n    \x3c!-- Features Grid --\x3e\n    <div class="row mb-5">\n        \x3c!-- Collections Card --\x3e\n        <div class="col-md-4 mb-4">\n            <div class="card feature-card">\n                <div class="card-body text-center">\n                    <div class="mb-3">\n                        <img src="/digital-textailes-archieve/static/Archieve_files/Icons/explore_collections_icon.png" alt="Explore Collections" style="width: 80px; height: 80px;">\n                    </div>\n                    <h3>Explore Collections</h3>\n                    <p>Browse 8 use cases featuring ancient textiles, archaeological artifacts, and museum collections digitized in 3D.</p>\n                    <a href="/digital-textailes-archieve/collections" class="btn btn-primary">View Collections</a>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- Toolbox Card --\x3e\n        <div class="col-md-4 mb-4">\n            <div class="card feature-card">\n                <div class="card-body text-center">\n                    <div class="mb-3">\n                        <img src="/digital-textailes-archieve/static/Archieve_files/Icons/toolbox_icon.png" alt="Digital Toolbox" style="width: 80px; height: 80px;">\n                    </div>\n                    <h3>Digital Toolbox</h3>\n                    <p>Explore our comprehensive suite of tools, including our robotic imaging system, 3D reconstruction pipeline, annotation platform, and AI-powered detection, segmentation, and classification tools. Access GitHub repositories, detailed documentation, and live demos to test and implement these solutions for your own projects.</p>\n                    <a href="/digital-textailes-archieve/toolbox" class="btn btn-primary">Explore Tools</a>\n                </div>\n            </div>\n        </div>\n\n        \x3c!-- Featured Artifact Card --\x3e\n        <div class="col-md-4 mb-4">\n            <div class="card feature-card">\n                <div class="card-body">\n                    <h3 class="text-center">Featured Artifact</h3>\n                    <div class="model-viewer-container">\n                        <model-viewer \n                            src="/digital-textailes-archieve/assets/${a.gltf_file||a.obj_file||""}"\n                            alt="Featured Artifact"\n                            auto-rotate\n                            camera-controls\n                            style="width: 100%; height: 100%;">\n                        </model-viewer>\n                    </div>\n                    <div class="text-center mt-3">\n                        <p class="mb-2"><strong>${a.title||"Explore our collection"}</strong></p>\n                        <a href="/digital-textailes-archieve/artifact/${a.id||"1"}" class="btn btn-primary btn-sm">View Details</a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n\x3c!-- Statistics Bar --\x3e\n<div class="stats-bar">\n    <div class="container">\n        <div class="row">\n            <div class="col-md-4 stat-item">\n                <div class="stat-number">${i}</div>\n                <div class="stat-label">Digitized Artifacts</div>\n            </div>\n            <div class="col-md-4 stat-item">\n                <div class="stat-number">8</div>\n                <div class="stat-label">Use Cases</div>\n            </div>\n            <div class="col-md-4 stat-item">\n                <div class="stat-number">6</div>\n                <div class="stat-label">Our Tools</div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="container mb-5"></div>\n\n\n<footer class="footer mt-auto">\n    <div class="dark-footer h-75">\n        <div class="container py-4">\n            <div class="row dark-footer">\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center py-2">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/EN_FundedbytheEU_RGB_NEG-1024x228.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<div class="footerLink pt-1">\n                        <p>TEXTaiLES is a project funded by the European Commission under Grant Agreement n.101158328. The views and opinions expressed in this website are the sole responsibility of the author and do not necessarily reflect the views of the European Commission.</p>\n                        <p><small><br>\n                        <br>\n                        <br>\n                        <a class="plainlink" href="mailto:archive@n-t.gr" title="contact us" alt="contact mail"></a></small></p>\n                    </div>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 vertical-line-right text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/ECHOES_Logo_White_Horizontal_300x300-1024x221.png" style="max-width: 300px;">\n                        </a>\n                    </p>\n\t\t\t\t\t<p>TEXTaiLES is part of the ECCCH initiative.</p>\n                </div>\n                <div class="col-lg-4 col-md-4 col-sm-12 text-lg-start text-sm-center pt-4">\n                    <p class="pt-4">\n                        <a href="https://textailes-eccch.eu/">\n                            <img src="/digital-textailes-archieve/static/Archieve_files/WBF_SBFI_EU_Frameworkprogramme_E_RGB_neg_hoch.png" style="max-width: 350px;">\n                        </a>\n                    </p>\n                </div>\n            </div>\n        </div>\n    </div>\n</footer>\n\n<script src="/digital-textailes-archieve/static/Archieve_files/jquery-3.6.0.min.js.download"><\/script>\n<script src="/digital-textailes-archieve/static/Archieve_files/bootstrap.bundle.min.js.download"><\/script>\n</body>\n</html>`;e.set("Content-Type","text/html"),e.set("Content-Security-Policy",s),e.send(l)}catch(t){console.error("Root route error:",t),e.status(500).send("Error: "+t.message)}})})(t,e),$(t,e)};
